/**
 * Minified by jsDelivr using Terser v5.37.0.
 * Original file: /npm/barea.js@1.2.1/barea.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";const getBareaApp=function(e){return new BareaApp(e)};class BareaApp{#e;#t=0;#r=0;#a;#n=new WeakMap;#i=new Map;#s=[];#l;#o={};#d=[];#c=!1;#p=null;#u={};#h=!1;#m=!1;#_=null;#E=null;constructor(e){e&&(this.#h=e),this.#E=this.#P(),this.#_=this.#f(this.#R),this.#I()}mount(e,t){if(this.#c)return;if(this.#c=!0,!t)return void console.error("Illegal use of mount, please pass a content object with data and methods");if(!t.data)return void console.error("Illegal use of mount, please pass a content object with data and methods");if(!e)return void console.error("Illegal use of mount, please pass an element or an element identifier");if(this.#e="object"==typeof e?e:document.getElementById(e),this.#l=t.data,this.#a=t.data,t.methods&&(this.#o=t.methods,Object.assign(this,this.#o),Object.keys(t.methods).forEach((e=>{"function"==typeof this[e]&&(this[e]=this[e].bind(this))}))),t.computed&&(Object.keys(t.computed).forEach((e=>{"function"==typeof t.computed[e]&&(this.#u[e]=this.#y(t.computed[e],e),this.#s.push(e))})),Object.keys(this.#u).forEach((e=>{Object.defineProperty(this,e,{get:()=>this.#u[e].value,enumerable:!0,configurable:!0})}))),t.mounted&&(this.#p=t.mounted),this.#m?document.addEventListener("DOMContentLoaded",this.#D):document.querySelectorAll(".ba-cloak").forEach((e=>e.classList.remove("ba-cloak"))),!("fetch"in window&&"Promise"in window&&"Symbol"in window&&"Map"in window))return void console.error("Your browser and js engine is too old to use this script");const r=this.#T(((e,t,r,a,n="")=>{let i=this.#v(1);if(i.active&&console.log(i.name,e,t,r,a,n),Array.isArray(t)&&BareaHelper.ARRAY_FUNCTIONS.includes(n)){let a=BareaHelper.getLastBareaObjectName(e);r=BareaHelper.getLastBareaKeyName(e),(t=this.getProxifiedPathData(a))||console.error("could not find array on path: "+e)}this.#_.notify(e,t,r,a,n)}),this.#l);return this.#a=r,this.#B(),this.#h&&!this.#a.hasOwnProperty("baId")&&(this.#a.baId=++this.#t),this.#p&&this.#p.apply(this,[this.#a]),this.#a}getData(){if(this.#c)return this.#a;console.warn("barea.js is not mounted. Call mount on the instance before using this method.")}enableHideBeforeLoaded(e){this.#H(e)&&(this.#m=e)}addHandler(e,t){"function"==typeof t?this.#o[e]=t:console.warn(`Handler for "${e}" is not a function.`)}getProxifiedPathData(e){if(!e)return this.#a;const t=e.match(/[^.[\]]+/g);if(!t)return this.#a;let r=this.#a;for(let e=0;e<t.length;e++)if(0!==e||"root"!==t[e].toLowerCase()){if(!r)return;r=r[t[e]]}return r}getPathData(e){if(!e)return this.#l;const t=e.match(/[^.[\]]+/g);if(!t)return this.#l;let r=this.#l;for(let e=0;e<t.length;e++)if(0!==e||"root"!==t[e].toLowerCase()){if(!r)return;r=r[t[e]]}return r}getObjectDictionary(e,t=""){let r={};for(const a in e)if(e.hasOwnProperty(a)){const n=t?`${t}.${a}`:a;"object"==typeof e[a]&&null!==e[a]?Array.isArray(e[a])?(r[n]=e[a],e[a].forEach(((e,t)=>{r[`${n}[${t}]`]=e,Object.assign(r,this.getObjectDictionary(e,`${n}[${t}]`))}))):(r[n]=e[a],Object.assign(r,this.getObjectDictionary(e[a],n))):r[n]=e[a]}return r}#T(e,t,r="root"){return new Proxy(t,{get:(t,a,n)=>{let i=Reflect.get(t,a,n);if(a===Symbol.iterator)return function*(){let a=0;for(let n of t){let t=`${r}[${a++}]`;if("object"==typeof n&&null!==n)if(this.#n.has(n))yield this.#n.get(n);else{const r=this.#T(e,n,t);this.#n.set(n,r),yield r}else yield n}}.bind(this);const s=Array.isArray(t)?`${r}[${a}]`:`${r}.${a}`;if("function"!=typeof i&&this.#E.track(s,null),"object"==typeof i&&null!==i){if(Array.isArray(i)||!this.#h||i.hasOwnProperty("baId")||(i.baId=++this.#t),this.#n.has(i))return this.#n.get(i);const t=this.#T(e,i,s);return this.#n.set(i,t),t}return"function"==typeof i&&BareaHelper.ARRAY_FUNCTIONS.includes(i.name)?(this.#r++,(...a)=>{let s=[];a.forEach((t=>{let r=null;"object"==typeof t?(r=this.#T(e,t),this.#n.has(t)||this.#n.set(t,r)):r=t,s.push(r)}));const l=i.apply(t,a);return this.#E.notify(r,i.name),e(r,n,"",s,i.name),l}):i},set:(t,a,n,i)=>{const s=Array.isArray(t)?`${r}[${a}]`:`${r}.${a}`;return"function"==typeof n&&!BareaHelper.ARRAY_FUNCTIONS.includes(n.name)||(t[a]===n||(t[a]=n,"function"==typeof n&&BareaHelper.ARRAY_FUNCTIONS.includes(n.name)?this.#E.notify(s,n.name):this.#E.notify(s,null),e(s,i,a,i[a])),!0)}})}#B(e=this.#e,t={template:null,rendereddata:null,renderedindex:-1,renderedvarname:"",renderedobjid:-1}){let r=this.#O();Array.from(e.querySelectorAll("*")).filter((e=>e.attributes.length&&Array.prototype.some.call(e.attributes,(e=>e.name.startsWith("ba-"))))).forEach((e=>{const a=Array.from(e.attributes).filter((e=>e.name.startsWith("ba-"))).map((e=>({name:e.name,value:e.value})));r.includes(e)||a.forEach((r=>{if(r.value)if(this.#r++,BareaHelper.DIR_GROUP_BIND_TO_PATH.includes(r.name)){const a=this.#C(r.value,r.name);if(a===BareaHelper.EXPR_TYPE_INVALID)return void console.error(`The ${r.name} directive with value: (${r.value}) is invalid.`);let n="",i=-1;BareaHelper.DIR_GROUP_UI_DUPLEX.includes(r.name)&&(n=e.getAttribute("type"),n?(i=1,"text"===n.toLowerCase()&&(i=1),"checkbox"===n.toLowerCase()&&(i=2),"radio"===n.toLowerCase()&&(i=3)):i=4);let s=this.#N(t,e,r.name,r.value,null,"",i);if(s.expressiontype=a,!t.rendereddata||r.value.startsWith(BareaHelper.ROOT_OBJECT)){let e=BareaHelper.getLastBareaObjectName(r.value);s.data=this.getProxifiedPathData(e),s.key=BareaHelper.getLastBareaKeyName(r.value)}else s.data=t.rendereddata,s.key=BareaHelper.getLastBareaKeyName(r.value);if(!s.data||!s.key)return void console.error(`Could not track directive ${r.name}${r.value} could not match data at the given path`);let l=e.getAttribute(BareaHelper.DIR_BIND_HANDLER);if(l){if(this.#C(l,BareaHelper.DIR_BIND_HANDLER)===BareaHelper.EXPR_TYPE_INVALID)return void console.error(`The ${BareaHelper.DIR_BIND_HANDLER} directive has an invalid value (${l}), should be funcname(), or funcname(args..).`);s.hashandler=!0,s.handlername=l}if(this.#_.track("value",s),BareaHelper.DIR_GROUP_UI_DUPLEX.includes(s.directivename)){s.hashandler&&this.#g(BareaHelper.VERB_SET_UI,s),s.inputtype===BareaHelper.UI_INPUT_TEXT?this.#A(s):s.inputtype===BareaHelper.UI_INPUT_CHECKBOX?this.#b(s):s.inputtype===BareaHelper.UI_INPUT_RADIO&&this.#k(s);let t=s.directivename===BareaHelper.DIR_BIND?"input":"blur";e.addEventListener(t,(t=>{if(s.hashandler)return void this.#g(BareaHelper.VERB_SET_DATA,s);const r=this.#v(3);s.inputtype===BareaHelper.UI_INPUT_CHECKBOX?(r.active&&console.log(r.name,"type: "+e.type,"key: "+valuekey,"input value: "+e.checked),s.data[s.key]=e.checked):s.inputtype===BareaHelper.UI_INPUT_RADIO?(r.active&&console.log(r.name,"type: "+e.type,"key: "+valuekey,"input value: "+e.value),e.checked&&(s.data[s.key]=e.value)):(r.active&&console.log(r.name,"type: "+e.type,"key: "+valuekey,"input value: "+e.value),s.data[s.key]=e.value)}))}else if(s.directivename===BareaHelper.DIR_CLASS){let t=e.getAttribute("classNames");s.orgvalue=t,this.#x(s)}else s.directivename===BareaHelper.DIR_HREF?this.#L(s):s.directivename===BareaHelper.DIR_IMAGE_SRC&&this.#U(s)}else if(BareaHelper.DIR_GROUP_COMPUTED.includes(r.name)){const a=this.#C(r.value,r.name,t.renderedvarname);if(a===BareaHelper.EXPR_TYPE_INVALID)return void console.error(`Then ${r.name} directive has an invalid value (${r.value}).`);const n=this.#$(t,e,r.name,r.value);n.expressiontype=a,t.rendereddata?n.data=t.rendereddata:n.data=this.#a,n.key="";let i=r.value.trim();i.includes("?")&&(i=i.split("?")[0]);let s=!1,l=this.#i.get(r.value);if(l&&!t.rendereddata||(s=!0,l=t.template?`${BareaHelper.META_DYN_TEMPLATE_FUNC_PREFIX}${this.#r}`:`${BareaHelper.META_DYN_FUNC_PREFIX}${this.#r}`,this.#i.set(r.value,l)),r.name===BareaHelper.DIR_IF&&(n.elementnextsibling=e.nextSibling,n.parentelement=e.parentElement),a===BareaHelper.EXPR_TYPE_COMPUTED)n.handlername=i,this.#u[n.handlername].addDependentDirective(n),this.#X(n);else if(a===BareaHelper.EXPR_TYPE_ROOT_EXPR){const t=this.#a,a=function(){return i=i.replaceAll("root.","contextdata."),function(t,a){try{return new Function("contextdata",`return ${t};`)(a)}catch(a){return console.error(`Error evaluating expression ${t} on ${e.localName} with attribute ${r.name}`),!1}}(i,t)};s&&(this.#u[l]=this.#y(a,l),this.#s.push(l)),n.handlername=l,n.iscomputed=!0,this.#u[n.handlername].addDependentDirective(n),this.#X(n)}else if(a===BareaHelper.EXPR_TYPE_OBJREF_EXPR){const a=function(){return i=i.replaceAll(t.renderedvarname+".","contextdata."),function(t,a){try{return new Function("contextdata",`return ${t};`)(a)}catch(a){return console.error(`Error evaluating expression ${t} on ${e.localName} with attribute ${r.name}`),!1}}(i,n.data)};if(!t.renderedvarname)return void console.error(`Invalid expression: ${i} to use as a dynamicly created function in a template.`);s&&(this.#u[l]=this.#y(a,l),this.#s.push(l)),n.handlername=l,n.iscomputed=!0,this.#u[n.handlername].addDependentDirective(n),this.#X(n)}else if(a===BareaHelper.EXPR_TYPE_MIX_EXPR){const a=n.data,o=this.#a,d=function(){return i=i.replaceAll("root.","rootdata."),i=i.replaceAll(t.renderedvarname+".","subdata."),function(t,a,n){try{return new Function("subdata","rootdata",`return ${t};`)(a,n)}catch(a){return console.error(`Error evaluating mixed expression ${t} on ${e.localName} with attribute ${r.name}`),!1}}(i,a,o)};if(!t.renderedvarname)return void console.error(`Invalid expression: ${i} to use as a dynamicly created function in a template.`);s&&(this.#u[l]=this.#y(d,l),this.#s.push(l)),n.handlername=l,n.iscomputed=!0,this.#u[n.handlername].addDependentDirective(n),this.#X(n)}}else if(BareaHelper.DIR_GROUP_TRACK_AND_FORGET.includes(r.name)){const a=this.#C(r.value,r.name);if(a===BareaHelper.EXPR_TYPE_INVALID)return void console.error(`Then ${r.name} directive has an invalid value (${r.value}).`);a===BareaHelper.EXPR_TYPE_HANDLER&&e.addEventListener("click",(a=>{let n=this.#a,i=e.getAttribute(BareaHelper.META_PATH);i?n=this.getProxifiedPathData(i):t.rendereddata&&(n=t.rendereddata);let s=[a,e,n],l=BareaHelper.parseBareaFunctionCall(r.value);s.push(...l.params),this.#o[l.functionName]?this.#o[l.functionName].apply(this,s):console.warn(`Handler function '${l.functionName}' not found.`)}))}else if(BareaHelper.DIR_GROUP_MARKUP_GENERATION.includes(r.name)){const a=this.#C(r.value,r.name);if(a===BareaHelper.EXPR_TYPE_INVALID)return void console.error(`Then ${r.name} directive has an invalid value (${r.value}).`);let[n,i]=r.value.split(" in ").map((e=>e.trim()));if(!n)return void console.error(`No variable name was found in the ${r.name} expression`);if(!i)return void console.error(`No path or computed function was found in the ${r.name} expression`);let s=e.innerHTML.trim().replace(/>\s+</g,"><").replace(/(\S)\s{2,}(\S)/g,"$1 $2");const l=this.#S(t,e,r.name,r.value,null,"",e.parentElement,s,e.localName);if(l.expressiontype=a,a!==BareaHelper.EXPR_TYPE_COMPUTED){let t=BareaHelper.getLastBareaObjectName(i);if(l.data=this.getProxifiedPathData(t),l.key=BareaHelper.getLastBareaKeyName(i),e.remove(),!Array.isArray(l.data[l.key]))return void console.error(`could not find array for ${i} in  ${r.name} directive`);this.#_.track("value",l)}else this.#u[i].addDependentDirective(l),this.#_.track("computed",l);this.#w(l)}}))})),this.#F(e).forEach((e=>{let r=e.textNode,a=[];e.expressions.forEach((e=>{let n=e.replaceAll("{","").replaceAll("}","").trim();const i=this.#C(n,BareaHelper.DIR_INTERPOLATION,t.renderedvarname);if(i===BareaHelper.EXPR_TYPE_INVALID)return void console.error(`The ${DIR_INTERPOLATION} directive has an invalid expression (${n}).`);let s=this.#Y(t,BareaHelper.DIR_INTERPOLATION,n,null,"",r,e,r.nodeValue);if(s.expressiontype=i,i===BareaHelper.EXPR_TYPE_COMPUTED)s.isrendered=!1,s.iscomputed=!0,a.push(s);else if([BareaHelper.EXPR_TYPE_ROOT_PATH,BareaHelper.EXPR_TYPE_OBJREF,BareaHelper.EXPR_TYPE_OBJREF_PATH].includes(i)){let e=BareaHelper.ROOT_OBJECT;!t.rendereddata||n.startsWith(BareaHelper.ROOT_OBJECT)?(e=BareaHelper.getLastBareaObjectName(n),s.data=this.getProxifiedPathData(e)):s.data=t.rendereddata,s.key="";let r=BareaHelper.getLastBareaKeyName(n);r!==BareaHelper.OBJECT&&r!==e&&(s.key=r),s.isrendered=!1,s.iscomputed=!1,a.push(s)}else BareaHelper.INTERPOL_INDEX===i&&(s.isrendered=!0,s.iscomputed=!1,s.data=t.rendereddata,a.push(s),t.template&&(t.template.usesReRenderedInterpolation=!0))})),a.length>0&&a.forEach((e=>{e.nodeexpressions=a,e.isrendered?this.#_.track("nontrackable",e):e.iscomputed&&this.#u[e.directivevalue]?this.#u[e.directivevalue].addDependentDirective(e):e.key?this.#_.track("value",e):e.data&&this.#_.track("object",e),this.#j(e)}))}));let a=this.#v(4);a.active&&(length,console.log(a.name),this.#_.getAllDependencies().forEach(((e,t)=>{console.log(t,e)}))),a=this.#v(5),a.active&&(length,console.log(a.name),this.#E.getAllDependencies().forEach(((e,t)=>{console.log(t,e)})))}#F(e=this.#e){let t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:e=>e.nodeValue.includes("{{")&&e.nodeValue.includes("}}")?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}),r=[];for(;t.nextNode();){let e={textNode:t.currentNode,expressions:[]};e.expressions=this.#M(e.textNode.nodeValue),r.push(e)}return r}#O(e=this.#e){if(e!==this.#e)return;let t=[],r=[];function a(e,r){t.push(e);for(let t=0;t<e.children.length;t++)a(e.children[t])}return e.querySelectorAll(`[${BareaHelper.DIR_FOREACH}]`).forEach((e=>{let n=!0;t=[],Array.from(e.children).forEach((e=>a(e)));let i=e.getAttribute(BareaHelper.DIR_FOREACH),[s,l]=i.split(" in ").map((e=>e.trim()));s||(n=!1,console.error(`No variable name was found in the ${BareaHelper.DIR_FOREACH} expression: ${i}`),n=!1),l||(n=!1,console.error(`No path or computed function was found in the ${BareaHelper.DIR_FOREACH} expression: ${i}`),n=!1),t.forEach((e=>{BareaHelper.DIR_GROUP_BIND_TO_PATH.forEach((t=>{if(e.hasAttribute(t)){let r=e.getAttribute(t);r.includes(BareaHelper.ROOT_OBJECT)||r.includes(s)||(n=!1,console.error(`The ${t} expression ${r} used in an element under ${BareaHelper.DIR_FOREACH} does not match the ${BareaHelper.DIR_FOREACH} expression, data should be reference by '${s}'. or '${BareaHelper.ROOT_OBJECT}'.`),n=!1)}}))})),n?r.push(...t):e.parentElement.innerHTML=""})),r}#$(e,t,r,a){return{id:this.#r++,renderedobjid:e.renderedobjid,renderedvarname:e.renderedvarname,template:e.template,directivename:r,directivevalue:a,element:t,data:null,key:"",hashandler:!1,handlername:"",inputtype:-1,iscomputed:!0}}#N(e,t,r,a,n,i,s){return{id:this.#r++,renderedobjid:e.renderedobjid,renderedvarname:e.renderedvarname,template:e.template,directivename:r,directivevalue:a,element:t,data:n,key:i,hashandler:!1,handlername:"",inputtype:s,iscomputed:!1}}#S(e,t,r,a,n,i,s,l,o){return{id:this.#r++,renderedobjid:e.renderedobjid,renderedvarname:e.renderedvarname,template:e.template,directivename:r,directivevalue:a,element:t,data:n,key:i,hashandler:!1,handlername:"",inputtype:-1,iscomputed:!1,parentelement:s,templatemarkup:l,templatetagname:o,usesReRenderedInterpolation:!1}}#Y(e,t,r,a,n,i,s,l){return{id:this.#r++,renderedobjid:e.renderedobjid,renderedvarname:e.renderedvarname,template:e.template,directivename:t,directivevalue:r,element:null,data:a,key:n,hashandler:!1,handlername:"",inputtype:-1,iscomputed:!1,isrendered:!1,interpolatednode:i,expression:s,nodetemplate:l,nodeexpressions:[],renderedindex:e.renderedindex}}#R=(e,t,r,a,n,i)=>{n.forEach((e=>{if(BareaHelper.DIR_GROUP_BIND_TO_PATH.includes(e.directivename)){if(e.hashandler)return void this.#g(BareaHelper.VERB_SET_UI,e);BareaHelper.DIR_GROUP_UI_DUPLEX.includes(e.directivename)?e.inputType===BareaHelper.UI_INPUT_TEXT?this.#A(e):e.inputType===BareaHelper.UI_INPUT_CHECKBOX?this.#b(e):e.inputType===BareaHelper.UI_INPUT_RADIO&&this.#k(e):e.directivename===BareaHelper.DIR_CLASS?this.#x(e):e.directivename===BareaHelper.DIR_HREF?this.#L(e):e.directivename===BareaHelper.DIR_IMAGE_SRC&&this.#U(e)}else e.directivename===BareaHelper.DIR_INTERPOLATION?this.#j(e):BareaHelper.DIR_GROUP_MARKUP_GENERATION.includes(e.directivename)?i&&BareaHelper.ARRAY_FUNCTIONS.includes(i)?this.#w(e,a,null,i,r):this.#w(e,a,r,"",null):BareaHelper.DIR_GROUP_COMPUTED.includes(e.directivename)&&this.#X(e)}))};#X(e){let t=e.handlername,r=!1;if(this.#u[t]?r=this.#u[t].value:console.warn(`Computed boolean function '${t}' not found.`),e.directivename===BareaHelper.DIR_HIDE)e.element.style.display=r?"none":"";else if(e.directivename===BareaHelper.DIR_SHOW)e.element.style.display=r?"":"none";else if(e.directivename===BareaHelper.DIR_IF)this.#G(e,r);else if(e.directivename===BareaHelper.DIR_CLASS_IF){let t=e.directivevalue;t.includes("?")&&(t=t.split("?")[1]),this.#V(e,r,t)}}#g(e,t){t.handlerpieces||(t.handlerpieces=BareaHelper.parseBareaFunctionCall(t.handlername));let r=[];e===BareaHelper.VERB_SET_UI&&(r=[e,t.element,t.data[t.key]]),e===BareaHelper.VERB_SET_DATA&&(r=[e,t.element,t.data,t.key]),r.push(...t.handlerpieces.params),this.#o[t.handlerpieces.functionName]?this.#o[t.handlerpieces.functionName].apply(this,r):console.warn(`Handler function '${t.handlerpieces.functionName}' not found.`)}#V(e,t,r){let a=r.split(/[\s,]+/);t?a.forEach((t=>{e.element.classList.contains(t)||e.element.classList.add(t)})):a.forEach((t=>{e.element.classList.contains(t)&&e.element.classList.remove(t)}))}#G(e,t){t?e.element.parentNode||e.elementnextsibling&&e.parentelement.insertBefore(e.element,e.elementnextsibling):e.element.parentNode&&(e.elementnextsibling=e.element.nextSibling,e.element.remove())}#A(e){e.element&&e.element.value!==e.data[e.key]&&(e.data[e.key]?e.element.value=e.data[e.key]:e.element.value="")}#b(e){e.element&&e.element.checked!==e.data[e.key]&&(e.data[e.key]?e.element.checked=e.data[e.key]:e.element.checked=!1)}#k(e){e.element&&"radio"===e.element.type&&void 0!==e.data[e.key]&&e.element.checked!==(e.element.value===e.data[e.key])&&(e.element.checked=e.element.value===e.data[e.key])}#x(e){if(!e.data[e.key])return;e.orgvalue||(e.orgvalue="");let t=e.data[e.key];t.includes(",")&&(t=t.replaceAll(","," ")),e.element.className=t||e.orgvalue}#U(e){e.data[e.key]&&(e.element.src=e.data[e.key])}#L(e){e.data[e.key]&&(e.element.href=e.data[e.key])}#j(e){let t=e.interpolatednode,r=e.nodetemplate;e.nodeexpressions.forEach((t=>{let a="";const n=this.#C(t.directivevalue,BareaHelper.DIR_INTERPOLATION,e.renderedvarname);n!==BareaHelper.EXPR_TYPE_INVALID?(n===BareaHelper.EXPR_TYPE_COMPUTED?a=this.#u[t.directivevalue].value:[BareaHelper.EXPR_TYPE_ROOT_PATH,BareaHelper.EXPR_TYPE_OBJREF,BareaHelper.EXPR_TYPE_OBJREF_PATH].includes(n)?t.key&&t.data?a=t.data[t.key]:t.data&&(a=t.data):n===BareaHelper.INTERPOL_INDEX&&(a=String(e.renderedindex)),a||(a=""),"object"==typeof a&&(a=JSON.stringify(a)),r=r.replaceAll(t.expression,a)):console.error(`The ${BareaHelper.DIR_INTERPOLATION} directive has an invalid expression (${t.directivevalue}).`)})),t.textContent=r}#w(e,t="root",r,a,n){let i=!1,s=!1,l=[],[o,d]=e.directivevalue.split(" in ").map((e=>e.trim()));if(!o)return void console.error(`No variable name was found in the ${e.directivename} expression`);if(!d)return void console.error(`No path or computed function was found in the ${e.directivename} expression`);let c=this.#C(d,e.directivename);if(c!==BareaHelper.EXPR_TYPE_INVALID){if(!a||"shift"!==a&&"pop"!==a&&"splice"!==a||(i=!0),!a||"sort"!==a&&"reverse"!==a&&"splice"!==a||(s=!0),c===BareaHelper.EXPR_TYPE_COMPUTED&&(s=!0),a&&!BareaHelper.ARRAY_FUNCTIONS.includes(a)&&(s=!0),r&&!a&&(s=!0),c===BareaHelper.EXPR_TYPE_COMPUTED?this.#u[d]?l=this.#u[d].value:console.warn(`Could not find computed function name in the ${e.directivename} directive`):l=r||this.getProxifiedPathData(d),s){let t=0;this.#_.removeTemplateDependencies(e.id),e.parentelement.innerHTML="";const r=document.createDocumentFragment();l.forEach((a=>{let n=this.#J(e,o,a,t);r.appendChild(n),this.#B(n,{template:e,rendereddata:a,renderedindex:t,renderedvarname:o,renderedobjid:this.#r}),t++})),r.childElementCount>0&&e.parentelement.appendChild(r)}else if("push"===a&&n?n.forEach((t=>{let r=this.#J(e,o,t,-1);e.parentelement.appendChild(r)})):"unshift"===a&&n?n.reverse().forEach((t=>{let r=this.#J(e,o,t,-1);e.parentelement.insertBefore(r,e.parentelement.firstChild)})):"pop"===a?e.parentelement.removeChild(e.parentelement.lastChild):"shift"===a&&e.parentelement.removeChild(e.parentelement.firstChild),e.usesReRenderedInterpolation){let t=0;l.forEach((r=>{this.#_.getObjectDependencies(r,e.id).forEach((e=>{e.directivename===BareaHelper.DIR_INTERPOLATION&&e.isrendered&&(e.renderedindex=t,this.#j(e),t++)}))}))}i&&this.#_.removeDeletedElementDependencies(e.id)}else console.error(`The expression for the directive ${e.directivename} value: ${e.directivevalue} is not valid`)}#J(e,t,r,a=-1){this.#r++;const n=document.createElement(e.templatetagname);return n.innerHTML=e.templatemarkup,n.id?n.id=n.id+`-${this.#r}`:n.id=`${e.id}-${t}-${this.#r}`,n.querySelectorAll("*").forEach((e=>{e.id?e.id=e.id+`-${this.#r}`:e.id=`${t}-${this.#r}`;let r=e.getAttribute("for");r&&e.setAttribute("for",r+`-${this.#r}`)})),this.#B(n,{template:e,rendereddata:r,renderedindex:a,renderedvarname:t,renderedobjid:this.#r}),n}#C=function(e,t,r){return BareaHelper.DIR_GROUP_BIND_TO_PATH.includes(t)?e.includes("(")||e.includes(")")?BareaHelper.EXPR_TYPE_INVALID:e.includes(".")?e.toLowerCase().startsWith("root.")?BareaHelper.EXPR_TYPE_ROOT_PATH:BareaHelper.EXPR_TYPE_OBJREF_PATH:BareaHelper.EXPR_TYPE_INVALID:[BareaHelper.DIR_CLICK,BareaHelper.DIR_BIND_HANDLER].includes(t)?e.includes("(")&&e.includes(")")?BareaHelper.EXPR_TYPE_HANDLER:BareaHelper.EXPR_TYPE_INVALID:BareaHelper.DIR_GROUP_COMPUTED.includes(t)?e.includes("(")||e.includes(")")?BareaHelper.EXPR_TYPE_INVALID:e.includes("root.")?r&&e.includes(r+".")?BareaHelper.EXPR_TYPE_MIX_EXPR:BareaHelper.EXPR_TYPE_ROOT_EXPR:e.includes(".")?BareaHelper.EXPR_TYPE_OBJREF_EXPR:BareaHelper.EXPR_TYPE_COMPUTED:t===BareaHelper.DIR_FOREACH?e.includes("root.")?BareaHelper.EXPR_TYPE_ROOT_PATH:e.includes(".")?BareaHelper.EXPR_TYPE_INVALID:BareaHelper.EXPR_TYPE_COMPUTED:t===BareaHelper.DIR_INTERPOLATION?e.includes("(")||e.includes(")")?BareaHelper.EXPR_TYPE_INVALID:e.toLowerCase()===r+"."+BareaHelper.INTERPOL_INDEX?BareaHelper.INTERPOL_INDEX:e.toLowerCase().startsWith("root.")?BareaHelper.EXPR_TYPE_ROOT_PATH:e.includes(".")?BareaHelper.EXPR_TYPE_OBJREF_PATH:this.#s.includes(e)?BareaHelper.EXPR_TYPE_COMPUTED:BareaHelper.EXPR_TYPE_OBJREF:BareaHelper.EXPR_TYPE_INVALID};#M(e){return e.match(/\{\{\s*.*?\s*\}\}/g)||[]}#H(e){return null!==e&&"object"!=typeof e&&"function"!=typeof e}enableConsoleLog(e,t){const r=this.#d.findIndex((t=>t.id===e));-1!==r&&(this.#d[r].active=t)}#v(e){const t=this.#d.find((t=>t.id===e));return t||{id:-1,name:"",active:!1}}printConsoleLogs(){console.log("barea.js available logs:"),this.#d.forEach((e=>console.log(e)))}#I(){this.#d=[{id:1,name:"Proxy call back: ",active:!1},{id:2,name:"Update dom on proxy change: ",active:!1},{id:3,name:"Update proxy on user input: ",active:!1},{id:4,name:"Print UI dependency tracking: ",active:!1},{id:5,name:"Print computed dependency tracking: ",active:!1}]}#D=e=>{this.#m&&document.querySelectorAll(".ba-cloak").forEach((e=>e.classList.remove("ba-cloak")))};#y(e,t){let r=this,a=this.#E,n=this.#_;return new class{userInterfaces=new Set;constructor(e,t){this.name=t,this.getter=e,this.dirty=!0,this.dependencyPaths=new Set,this.setDirty=e=>{this.dirty=!0,n.notifyDependentUserInterface(this.userInterfaces)}}track(e,t){e.addSubscriber(this.name,this.setDirty),this.dependencyPaths.add(t)}addDependentDirective(e){this.userInterfaces.add(e)}get value(){return this.dirty&&(a.start(this),this._value=this.getter.call(r),a.stop(),this.dirty=!1),this._value}}(e,t)}#P(){let e;return new class{#K=null;#W=null;constructor(){if(e)return e;this.#K=new Map,e=this}start(e){this.#W=e}stop(){this.#W=null}getAllDependencies(){return this.#K}isDepencencyPath(e,t){if(!e)return!1;if(!t)return!1;if(!this.#K.has(e))return!1;for(let r of this.#K.keys()){if(r!==e)continue;let a=this.#K.get(r);for(let e of a.subscribers.keys())if(e===t)return!0}return!1}track(e,t){if(!e)return;if(e===BareaHelper.ROOT_OBJECT)return;let r="";if(r=t?e+"."+t.toLowerCase():e,this.#W){let e=this.#q(r);this.#W.track(e,r)}}notify(e,t){if(!e)return;if(e===BareaHelper.ROOT_OBJECT)return;let r="";r=t?e+"."+t.toLowerCase():e,this.#q(r).notify(r)}#q(e){let t=this.#K.get(e);return t||(t=this.#z(e),this.#K.set(e,t)),t}#z(e){let t=new Map;return{subscribers:t,addSubscriber(e,r){t.has(e)||t.set(e,r)},notify(e){t.forEach(((t,r)=>{t(e)}))}}}}}#f(e){let t,r=this.#u;return new class{#K=new Map;#Q=new WeakMap;#Z=null;#ee=0;#te=0;#re=0;constructor(e){if(t)return t;this.#Z=e,t=this}#ae(e){let t=!1,r=0;return this.#Q.has(e)||(t=!0,this.#Q.set(e,++this.#ee)),r=this.#Q.get(e),{id:r,isnew:t}}removeTemplateDependencies(e=-1){let t=[];this.#K.forEach(((r,a)=>{for(const n of r)n.template&&n.template.id===e&&-1!==e&&t.push(a)}));for(let e=0;e<t.length-1;e++)this.#K.delete(t[e]);Object.keys(r).forEach((t=>{for(let a of[...r[t].userInterfaces])a.template&&a.template.id===e&&r[t].userInterfaces.delete(a)}))}removeDeletedElementDependencies(e=-1){let t=[];this.#K.forEach(((r,a)=>{for(const n of r)n.template&&n.template.id===e&&-1!==e&&n.element&&!n.element.isConnected&&t.push(a)}));for(let e=0;e<t.length-1;e++)this.#K.delete(t[e]);Object.keys(r).forEach((t=>{for(let a of[...r[t].userInterfaces])a.template&&a.template.id===e&&a.element&&!a.element.isConnected&&r[t].userInterfaces.delete(a)}))}getObjectDependencies(e,t=-1){let r=[];return this.#K.forEach(((a,n)=>{for(const n of a)n.template&&n.data&&n.template.id===t&&Object.is(n.data,e)&&r.push(n)})),r}getAllDependencies(){return this.#K}track(e,t){if(this.#te++,t.data||t.isrendered||BareaHelper.DIR_GROUP_MARKUP_GENERATION.includes(t.directivename)||console.error("Tracked UI has no data",t),BareaHelper.DIR_GROUP_COMPUTED.includes(t.directivename))return;const r=t.data;let a="";return a="value"===e?this.#ae(r).id+":value:"+t.key:"object"===e?this.#ae(r).id+":object:":e,!!a&&(this.#K.has(a)||this.#K.set(a,new Set),this.#K.get(a).add(t),!0)}notify(e,t,r,a,n){this.#re++;let i=this.#ae(t);if(i.isnew)console.warn("UI dependency tracker was notified of an object that was not tracked",t);else{let s=i.id+":value:"+r,l=this.#K.get(s);l||(l=new Set),s=i.id+":object:";let o=this.#K.get(s);o||(o=new Set);let d=new Set([...l,...o]);if(0===d.size)return;this.#Z(t,r,a,e,d,n)}}notifyDependentUserInterface(e){e&&this.#Z(null,"",null,"",e,"")}}(e)}}class BareaHelper{static DIR_BIND="ba-bind";static DIR_BIND_BLUR="ba-bind-blur";static DIR_BIND_HANDLER="ba-bind-handler";static DIR_FOREACH="ba-foreach";static DIR_CLICK="ba-click";static DIR_CLASS="ba-class";static DIR_CLASS_IF="ba-class-if";static DIR_HIDE="ba-hide";static DIR_SHOW="ba-show";static DIR_IMAGE_SRC="ba-src";static DIR_IF="ba-if";static DIR_HREF="ba-href";static DIR_INTERPOLATION="interpolation";static DIR_GROUP_BIND_TO_PATH=[BareaHelper.DIR_BIND,BareaHelper.DIR_BIND_BLUR,BareaHelper.DIR_CLASS,BareaHelper.DIR_HREF,BareaHelper.DIR_IMAGE_SRC];static DIR_GROUP_UI_DUPLEX=[BareaHelper.DIR_BIND,BareaHelper.DIR_BIND_BLUR];static DIR_GROUP_TRACK_AND_FORGET=[BareaHelper.DIR_CLICK];static DIR_GROUP_COMPUTED=[BareaHelper.DIR_CLASS_IF,BareaHelper.DIR_HIDE,BareaHelper.DIR_SHOW,BareaHelper.DIR_IF];static DIR_GROUP_MARKUP_GENERATION=[BareaHelper.DIR_FOREACH];static UI_INPUT_TEXT=1;static UI_INPUT_CHECKBOX=2;static UI_INPUT_RADIO=3;static UI_INPUT_CUSTOM=4;static VERB_SET_DATA="SET_DATA";static VERB_SET_UI="SET_UI";static META_PATH="ba-path";static META_DYN_FUNC_PREFIX="dynFunc_";static META_DYN_TEMPLATE_FUNC_PREFIX="dynTemplFunc_";static INTERPOL_INDEX="index";static EXPR_TYPE_ROOT_PATH="root-path";static EXPR_TYPE_HANDLER="static-handler";static EXPR_TYPE_COMPUTED="computed";static EXPR_TYPE_OBJREF="child-obj";static EXPR_TYPE_OBJREF_PATH="child-obj-path";static EXPR_TYPE_OBJREF_EXPR="child-obj-expression";static EXPR_TYPE_ROOT_EXPR="root-expr";static EXPR_TYPE_MIX_EXPR="root-and-child-expression";static EXPR_TYPE_INVALID="invalid-expression";static ROOT_OBJECT="root";static ARRAY_FUNCTIONS=["push","pop","splice","shift","unshift","reverse","sort"];static getLastBareaKeyName=function(e){if(!e)return"root";let t=e.split(".");if(t.length<2)return"root";let r="";return t.forEach((e=>{r=e})),r};static getLastBareaObjectName=function(e){if(!e)return"root";let t=null,r=e.split(".");for(let e=0;e<r.length-1;e++)t?t+="."+r[e]:t=r[e];return null==t&&(t=e),t};static parseBareaFunctionCall=function(e){function t(e){return/^["'].*["']$/.test(e)?e.slice(1,-1):"true"===e||"false"!==e&&("null"===e?null:isNaN(e)?/^\[.*\]$/.test(e)?e.slice(1,-1).split(",").map((e=>t(e.trim()))):e:e.includes(".")?parseFloat(e):parseInt(e,10))}const r=e.match(/^(\w+)\((.*)\)$/);if(!r)return null;const[a,n,i]=r;return{functionName:n,params:i.trim()?[...i.matchAll(/'[^']*'|"[^"]*"|[^,]+/g)].map((e=>t(e[0].trim()))):[]}};static hasAnyChar=function(e,t){return t.some((t=>e.includes(t)))}}
//# sourceMappingURL=/sm/51fae11fb3d57c2491b9dc0da2c05dd8b543aeafb76b10e77eea7219eb0ef98c.map